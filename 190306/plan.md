# Модули-пакеты-библиотеки [00:20]
## Идеология [00:05]
* Много кода в одном файле непонятно, надо делить на логические куски
* В Python решили, что файл == модуль, папка с модулями и пакетами == пакет
* "Внешние зависимости":
  * Можно писать код не на Python, а на Си
  * Можно написать один код и использовать в нескольких языках
  * Правда, тогда сложнее: надо собирать под каждую систему (или компилировать Си на компьютере пользователя)
## Подгрузка модулей, import, from [00:10]
* `import` - это команда, исполняет и возвращает модуль
* Его `globals()` становятся `__dict__`/`dir()`
* Зачем нужен `__name__ == "__main__"`
* `from collections import *` - рекурсивная подгрузка, упс, но есть `__all__`
* `import foo.bar` против `from foo import bar`
* Рекурсивный `import a` - ок, только один раз (если только не `__main__`)
## Пути поиска [00:05]
* `sys.path`, можно менять
* Текущая папка в приоритете: не называйте `pandas.py` или `collections.py`

# Управление зависимостями [00:25]
## PyPI [00:05]
Только теория:

* Центральный репозиторий с библиотеками: https://pypi.org/project/pytest/
  * Обычно ничего скачивать руками не надо, есть пакетные менеджеры
  * Популярные пакеты с кодом на Си могут идти в скомпилированном виде (актуально для винды)
* Премодерации нет, могут быть вирусы: https://www.opennet.ru/opennews/art.shtml?num=49490
* В других современных языках есть аналоги (Maven Central, NPM)
* В компаниях могут настраивать свои репозитории, с модерацией и своими пакетами
## Глобальная установка и virtualenv [00:10]
Только теория:

* Можно ставить пакеты глобально, но:
  * Ровно одна версия, включая транзитивные зависимости
  * При скачивании проекта надо догадываться, что ему надо
* Есть virtualenv:
  * Создаёт копию питона (environment)
  * Надо "активировать" для использования или выбрать как SDK в PyCharm
  * Все пакеты ставятся туда и независимы от системного
* Можно в проекте прописать `requirements.txt` и
  автоматически скачать нужные библиотеки, особенно хорошо с virtualenv

На практике проще с глобальными:

* `setup.py` и `easy_install` - низкоуровневые утилиты, не надо использовать
* Под Linux надо использовать только готовые системные пакеты (в Ubuntu обычно `python3-*`)
* Под Windows/macOS/virtualenv можно использовать `pip`, ставит в текущее окружение (или глобальное)

## Поиск и использование библиотек [00:10]
* awesome-python и Google/GitHub со звёздочками для поиска
  * https://github.com/vinta/awesome-python
  * Осторожно с безопасностью!
* Читаем getting started, guide, примеры
  * Для Python хороший сайт - readthedocs.io
  * Поняли совсем базовый синтаксис, потом смотрим в документацию конкретных функций/классов
* Для конкретной задачи можно stackoverflow/копировать код, но это не очень:
  * Stackoverflow-driven development: https://meta.stackoverflow.com/a/361905/767632
  * Но можно найти код, понять, прочитать документацию, потом использовать

# Библиотеки для изображений [00:25]
## Особенности отрисовки текста [00:05]
* Baseline
* Шрифты (лучше встроенные)
## OpenCV [00:05]
* Для компьютерного зрения, но рисовать тоже умеет
* Исходно для плюсов
* Есть версии для кучи языков, в том числе Python
* Основная документация и примеры на C++, но в Python стараются сохранять названия функций
* Есть ещё Pillow для питона, она больше на работу с изображениями
## OpenCV: практика [00:20]
* Getting started with Images
* Drawing functions in OpenCV

# Примеры научных библиотек [00:20]
## Sympy
## Numpy
* Скорость выше, чем у простого Python
## Pandas
* Удобнее NumPy для таблиц
## Прочее [00:05]
* А ещё бывает seaborn, matplotlib
  * Отдельный микрокурс по анализу данных 
* Отдельный курс по ML

# Запросы к WWW [1:30]
Классический вопрос: https://habr.com/ru/company/htmlacademy/blog/254825/
## IPv4, TCP, NAT [00:20]
* Физический уровень: провод/Wi-Fi, пакеты, Ethernet и MAC-адрес, протокол ARP, свитчи/хабы
  * Для MAC: можно `ipconfig /all`, `ifconfig -a`
  * Для ARP: можно `arp -a`
* Разные подсети (чтобы было не очень много машин), IPv4-адреса, роутеры
* Маска подсети показывает, кому посылать сообщение на физическом уровне: роутеру или компьютеру
  * Посмотрите на маску подсети, попингуйте мой комп, посмотрите `arp -a`
* TCP эмулирует "трубу с данными" поверх IP, появляется "порт"
* Интернет - это много сетей, которые общаются вместе
* IPv4-адреса бывают специальные: для localhost, для локальных сетей (чтобы не путать с интернетом)
* IPv4-адресов в интернете всё равно:
  * Во внешний мир - один IP-адрес ("белый")
  * Внутри есть независимая сеть с локальными IP-адресам ("серые")
  * Когда роутер видит TCP-соединение в интернет, он его устанавливает "от своего имени"
    (напрямую не установить, потому что во внешнем мире про локальные адреса ничего не знают)
## DNS [00:10]
* У сайтов есть имена, надо по имени понять, к какому IP-адресу делать запрос
* Есть иерархия DNS-серверов плюс локальные кэширующие, их IP-адреса зашиты в конфигурацию
* Спрашиваем у DNS-сервера "записи" про имя (`nslookup -type=any google.com`, `gmail.com`),
  нас интересует `internet address` (`A`), их может быть несколько
## HTTP: GET-запрос [00:10]
* Браузеры используют протокол HTTP (поверх TCP)
* Консоль разработчика в браузере: можно смотреть отдельные запросы
* Код ответа (200 соблюдается, остальные не всегда)
  * Ещё бывает перенаправление
* Заголовки
  * Самый полезный - `Host`, чтобы было много серверов
  * Ещё можно указать, что лежит в теле ответа, длину...
* Тело ответа
  * Для 200 - страница
  * Для остальных (404) - какое-нибудь содержимое
* URL и query string (поиск в Google/Habr)
  * Конвенция с `&` и `key=value`
  * Строгого стандарта нет, кто во что горазд
## HTTP: практика [00:10]
* Утилита curl, существование PostMan и WireShark
* Библиотека requests
* Свой запрос через telnet/netcat: `vk.com`, но нужен заголовок `Host`
## Другие виды запросов [00:10]
* GET запрос
  * Не должен менять состояние (но иногда меняет)
  * Запрос по умолчанию
* Бывают другие виды запросов: POST, DELETE...
  * У не-GET запроса тоже может быть "тело запроса", обычно туда
    каким-то способом кодируется форма (пример)
  * У GET запроса тело может быть, не должно влиять (но кто на что горазд)
  * http://ptsv2.com/
## Использование API, ключи [00:30]
* Обычно для программ дают API - не HTML для человека, а JSON/XML/CSV/...
  * В Python есть `import json`
* Есть отдельная документация для разработчиков
  * https://www.cbr.ru/development/
* И ограничения на использование:
  * Количество запросов
  * Можно ли в коммерческих целях
  * Обычно анонимно запрос сделать нельзя
* Разбираем пример с нуля: https://tech.yandex.ru/maps/geosearch/
  * В браузере
  * В curl
  * В PostMan
  * В requests
  * Руками
* Также API бывает для сайтов типа ВК (теория):
  * Тут пользователь должен дать нашему приложению частичный доступ, пароль нельзя
  * Причём чтобы было чётко ясно, что это наше приложение (чтобы можно было убрать доступ/забанить)
  * Пользователь должен через сайт разрешить доступ
    * Есть конвенции OAuth о том, как это делать
